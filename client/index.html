<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SamarthClinics</title>
    <!-- Fix jQuery plugin errors by ensuring jQuery is loaded first -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- Add waypoints library to properly support scrolling features -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
    
    <!-- Add animate number plugin for counters -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-animateNumber/0.0.14/jquery.animateNumber.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // Enhanced jQuery plugin error prevention
      if (typeof jQuery !== 'undefined') {
        const $ = jQuery;
        
        // Prevent plugin errors from breaking React rendering
        window.addEventListener('error', function(event) {
          if (event.error && event.error.message && 
              (event.error.message.includes('waypoint') || 
               event.error.message.includes('magnificPopup') ||
               event.error.message.includes('lever.io') ||
               event.error.message.includes('iframe.src'))) {
            console.warn('Suppressed plugin error to prevent React breakage:', event.error.message);
            event.preventDefault();
            return false;
          }
        });
        
        // Suppress console errors that don't affect functionality
        const originalConsoleError = console.error;
        console.error = function(...args) {
          const message = args.join(' ');
          if (message.includes('lever.io') || 
              message.includes('iframe.src') ||
              message.includes('Waypoint plugin not available')) {
            // Suppress these specific errors
            return;
          }
          originalConsoleError.apply(console, args);
        };
        
        // Safe plugin initialization wrappers
        const safePluginWrapper = function(pluginName, fallbackFn) {
          return function() {
            try {
              if (typeof fallbackFn === 'function') {
                return fallbackFn.apply(this, arguments);
              }
              return $(this);
            } catch (error) {
              console.warn(`Plugin ${pluginName} error suppressed:`, error.message);
              return $(this);
            }
          };
        };
        
        // Fix magnificPopup error
        $.fn.magnificPopup = $.fn.magnificPopup || safePluginWrapper('magnificPopup', function() {
          return $(this);
        });
        
        // Fix waypoint error with safer implementation
        $.fn.waypoint = $.fn.waypoint || safePluginWrapper('waypoint', function(handler, options) {
          // Only execute if we're not in a React-managed element
          if ($(this).closest('[data-reactroot], #root').length === 0) {
            if (typeof handler === 'function') {
              setTimeout(() => {
                try {
                  handler.call({element: this[0]}, 'down');
                } catch (e) {
                  console.warn('Waypoint handler error:', e.message);
                }
              }, 100);
            }
          }
          return $(this);
        });
        
        // Fix animateNumber
        if (!$.animateNumber || !$.animateNumber.numberStepFactories) {
          $.animateNumber = $.animateNumber || {};
          $.animateNumber.numberStepFactories = {
            separator: function(sep) {
              return function(now, tween) {
                return Math.floor(now).toString().replace(/\B(?=(\d{3})+(?!\d))/g, sep);
              };
            }
          };
          
          $.fn.animateNumber = $.fn.animateNumber || safePluginWrapper('animateNumber', function(options) {
            return $(this);
          });
        }
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
